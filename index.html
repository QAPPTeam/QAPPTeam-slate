
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#users" class="toc-h1 toc-link" data-title="Users">Users</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#signup-endpoints-researcher" class="toc-h2 toc-link" data-title="Signup endpoints -- researcher">Signup endpoints -- researcher</a>
                  </li>
                  <li>
                    <a href="#signup-endpoints-researcher-2" class="toc-h2 toc-link" data-title="Signup endpoints -- researcher">Signup endpoints -- researcher</a>
                  </li>
                  <li>
                    <a href="#login-endpoint" class="toc-h2 toc-link" data-title="Login endpoint">Login endpoint</a>
                  </li>
                  <li>
                    <a href="#logout-endpoint" class="toc-h2 toc-link" data-title="logout endpoint">logout endpoint</a>
                  </li>
                  <li>
                    <a href="#user-update-endpoint" class="toc-h2 toc-link" data-title="User Update Endpoint">User Update Endpoint</a>
                  </li>
                  <li>
                    <a href="#participant-signs-up-for-a-study" class="toc-h2 toc-link" data-title="participant signs up for a study">participant signs up for a study</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#studies" class="toc-h1 toc-link" data-title="Studies">Studies</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#create-studies" class="toc-h2 toc-link" data-title="Create studies">Create studies</a>
                  </li>
                  <li>
                    <a href="#get-all-studies" class="toc-h2 toc-link" data-title="get all studies">get all studies</a>
                  </li>
                  <li>
                    <a href="#get-studies-by-their-id" class="toc-h2 toc-link" data-title="get Studies by their ID">get Studies by their ID</a>
                  </li>
                  <li>
                    <a href="#get-studies-by-other-parameters" class="toc-h2 toc-link" data-title="get studies by other parameters">get studies by other parameters</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#messageing-system-instruction" class="toc-h1 toc-link" data-title="Messageing system instruction">Messageing system instruction</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#files" class="toc-h2 toc-link" data-title="files">files</a>
                  </li>
                  <li>
                    <a href="#how-to-use-it" class="toc-h2 toc-link" data-title="how to use it">how to use it</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#usage-of-email-js-and-job-js" class="toc-h1 toc-link" data-title="usage of email.js and job.js">usage of email.js and job.js</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#email" class="toc-h2 toc-link" data-title="email">email</a>
                  </li>
                  <li>
                    <a href="#need-test" class="toc-h2 toc-link" data-title="NEED TEST!">NEED TEST!</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#todo" class="toc-h1 toc-link" data-title="TODO">TODO</a>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://github.com/lord/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Welcome to the API documentation page.</p>

<p>This API is currently being hosted on <a href="https://research-stream.herokuapp.com/">Heroku</a> and uses MongoDB Atlas to host the databases.</p>

<p>This example API documentation page was created with <a href="https://github.com/lord/slate">Slate</a>.</p>
<h1 id='users'>Users</h1><h2 id='signup-endpoints-researcher'>Signup endpoints -- researcher</h2><pre class="highlight javascript tab-javascript"><code>
<span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span> 
                <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"aname"</span><span class="p">,</span>
                <span class="s2">"institution"</span><span class="p">:</span> <span class="s2">"an institution"</span><span class="p">,</span>
                <span class="s2">"department"</span><span class="p">:</span> <span class="s2">"department"</span><span class="p">,</span>
                <span class="s2">"address"</span><span class="p">:</span> <span class="s2">"an address"</span><span class="p">,</span>
                <span class="s2">"country"</span><span class="p">:</span> <span class="s2">"a country"</span><span class="p">,</span>
                <span class="s2">"phonenum"</span><span class="p">:</span> <span class="s2">"a number"</span><span class="p">,</span>
                <span class="s2">"email"</span><span class="p">:</span> <span class="s2">"an email"</span><span class="p">,</span>
                <span class="s2">"password"</span><span class="p">:</span> <span class="s2">"a password"</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1">//this code registers a researcher</span>
<span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">'https://research-stream.herokuapp.com/user/registerResearcher '</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">),</span>
<span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
  <span class="p">})</span>

</code></pre>
<blockquote>
<p>Signup endpoints are different for participants and researcher</p>
</blockquote>

<p>This function returns a json of the new user information in the form of the dataResearcher variable and prints this json to the console</p>

<p>HTTP request</p>

<ul>
<li>POST https://research-stream.herokuapp.com/user/registerResearcher </li>
</ul>
<h3 id='parameters-for-researchers'>parameters for researchers</h3>
<ul>
<li>name</li>
<li>institution</li>
<li>department</li>
<li>address</li>
<li>country</li>
<li>phone number</li>
<li>email</li>
<li>password</li>
</ul>
<h2 id='signup-endpoints-researcher-2'>Signup endpoints -- researcher</h2><pre class="highlight javascript tab-javascript"><code>
<span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span> 
                <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"aname"</span><span class="p">,</span>
                <span class="s2">"age"</span><span class="p">:</span> <span class="s2">"a number"</span><span class="p">,</span>
                <span class="s2">"city"</span><span class="p">:</span> <span class="s2">"a city"</span><span class="p">,</span>
                <span class="s2">"phonenum"</span><span class="p">:</span> <span class="s2">"a number"</span><span class="p">,</span>
                <span class="s2">"email"</span><span class="p">:</span> <span class="s2">"an email"</span><span class="p">,</span>
                <span class="s2">"password"</span><span class="p">:</span> <span class="s2">"a password"</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1">//this code registers a researcher</span>
<span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">'https://research-stream.herokuapp.com/user/registerParticipant '</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">),</span>
<span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
  <span class="p">})</span>

</code></pre>
<blockquote>
<p>Signup endpoints are different for participants and researcher</p>
</blockquote>

<p>This function returns a json of the new user information in the form of the dataResearcher variable and prints this json to the console</p>

<p>HTTP requests</p>

<ul>
<li>POST https://research-stream.herokuapp.com/user/registerParticipant</li>
</ul>
<h3 id='parameters-for-participants'>parameters for participants</h3>
<ul>
<li>Name</li>
<li>age</li>
<li>city</li>
<li>phone number</li>
<li>email</li>
<li>password</li>
</ul>
<h2 id='login-endpoint'>Login endpoint</h2><pre class="highlight javascript tab-javascript"><code>
<span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"email"</span><span class="p">:</span><span class="s2">"sppedster2@gmail.com"</span><span class="p">,</span>
    <span class="s2">"password"</span><span class="p">:</span><span class="s2">"password"</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">'http://localhost:5000/user/login '</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">),</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">();</span>
<span class="p">})</span>

</code></pre>
<p>The User is identified by a unique email
The login endpoint saves a user&#39;s unique ID to a session state to that it can be checked before the user accesses other checkpoints.
All the endpoints following this one require the login endpoint to be run first</p>

<p>Login is accessed via the endpoint</p>

<ul>
<li>https://research-stream.herokuapp.com/user/login</li>
</ul>
<h3 id='login-parameters'>login parameters</h3>
<ul>
<li>email</li>
<li>password</li>
</ul>
<h2 id='logout-endpoint'>logout endpoint</h2><pre class="highlight javascript tab-javascript"><code>
<span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">'https://research-stream.herokuapp.com/user/logout '</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">method</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">();</span>
  <span class="p">})</span>

</code></pre>
<p>This returns a string stateting the user is logged out successfully, there are no parameters, if a user is not logged in the returned string will state this information instead</p>
<h2 id='user-update-endpoint'>User Update Endpoint</h2>
<blockquote>
<p>to update a participant different data needs to be used but they are both updates using the same endpoint</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code>
<span class="c1">//data variable should be in the same format as the create user data values depending on the type of user</span>
<span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span> 
                <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"aname"</span><span class="p">,</span>
                <span class="s2">"age"</span><span class="p">:</span> <span class="s2">"a number"</span><span class="p">,</span>
                <span class="s2">"city"</span><span class="p">:</span> <span class="s2">"a city"</span><span class="p">,</span>
                <span class="s2">"phonenum"</span><span class="p">:</span> <span class="s2">"a number"</span><span class="p">,</span>
                <span class="s2">"email"</span><span class="p">:</span> <span class="s2">"an email"</span><span class="p">,</span>
                <span class="s2">"password"</span><span class="p">:</span> <span class="s2">"a password"</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1">//this code registers a researcher</span>
<span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">'https://research-stream.herokuapp.com/user/update '</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">),</span>
<span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">();</span>
  <span class="p">})</span>
</code></pre>
<p>This enpoint updates user information. An array of all the user information (wether its being updated or not) is sent to this endpoint, and it will change the information of the user that is already logged in.</p>

<p>this endpoint returns a success message if the update was successfull</p>

<p>HTTP request</p>

<ul>
<li>POST https://research-stream.herokuapp.com/user/update</li>
</ul>

<table><thead>
<tr>
<th>researcher</th>
<th>participant</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>Name</td>
</tr>
<tr>
<td>institution</td>
<td>age</td>
</tr>
<tr>
<td>department</td>
<td>city</td>
</tr>
<tr>
<td>address</td>
<td>phone number</td>
</tr>
<tr>
<td>country</td>
<td>email</td>
</tr>
<tr>
<td>phone number</td>
<td>password</td>
</tr>
</tbody></table>

<p>email
 password</p>
<h2 id='participant-signs-up-for-a-study'>participant signs up for a study</h2><pre class="highlight javascript tab-javascript"><code>
<span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">'https://research-stream.herokuapp.com/user/signup/&lt;the id of a study&gt;/&lt;the date the participant is signin up for&gt; '</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">),</span>
<span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">();</span>
  <span class="p">})</span>
</code></pre>
<p>This is the endpoint used when a perticipant is logged in and wants to sign up for a study
it returns a success message if the participant is signed up successfully</p>

<p>a participant cannot sign up for a trial more than once and cannot sign up for a time slot thats aready been filled</p>
<h3 id='parameters'>parameters</h3>
<ul>
<li>_id of the study</li>
<li>date of the trial</li>
</ul>
<h1 id='studies'>Studies</h1><h2 id='create-studies'>Create studies</h2>
<blockquote>
<p>before accessing this endpoint, access the login enpoint with researcher credentials</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code>
<span class="kd">var</span> <span class="nx">fileField</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">"input[type='file'][multiple]"</span><span class="p">);</span> <span class="c1">//use htmp form with &lt;input type="file" /&gt;</span>

<span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"name"</span> <span class="p">:</span> <span class="s2">"new study"</span><span class="p">,</span>
    <span class="s2">"details"</span><span class="p">:</span> <span class="s2">"s detail"</span><span class="p">,</span>
    <span class="s2">"lab"</span><span class="p">:</span> <span class="s2">"a lab"</span><span class="p">,</span>
    <span class="s2">"contactInfo"</span> <span class="p">:</span> <span class="s2">"some contact information"</span><span class="p">,</span>
    <span class="s2">"location"</span> <span class="p">:</span> <span class="s2">"a place"</span><span class="p">,</span>
    <span class="s2">"compensation"</span><span class="p">:</span> <span class="s2">"prob money"</span><span class="p">,</span>
    <span class="s2">"criteria"</span> <span class="p">:</span> <span class="s2">"a person"</span><span class="p">,</span>
    <span class="s2">"expectation"</span> <span class="p">:</span> <span class="s2">"an expectation"</span><span class="p">,</span>
    <span class="s2">"emaildateoffset"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">"dates"</span><span class="p">:</span> <span class="s2">"[01.01.2018, 01.02.2018]"</span><span class="c1">//etc</span>
<span class="p">}</span>

<span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'ethics'</span><span class="p">,</span> <span class="nx">fileField</span><span class="p">.</span><span class="nx">files</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'emailcontent'</span><span class="p">,</span> <span class="nx">fileField</span><span class="p">.</span><span class="nx">files</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">'https://research-stream.herokuapp.com/study/create '</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">),</span>
<span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
  <span class="p">})</span>

</code></pre>
<p>Creates a study and saves it to the studies collection of the database.</p>

<p>The email and the name of the researcher is taken from the login information and the field &quot;ethicsClearance&quot; stores a file for the proof of ethics clearance - the file must be less than 14 mb</p>

<p>This enpdoint is also used to update a study, all fields can be changes except the researcher email and name (unless these are fist changed in the user object)</p>
<h3 id='http-request'>HTTP request</h3>
<ul>
<li>POST https://research-stream.herokuapp.com/study/create</li>
</ul>
<h3 id='study-paratemers'>study paratemers</h3>
<ul>
<li>name</li>
<li>details</li>
<li>lab</li>
<li>contactInfo</li>
<li>location</li>
<li>compensation</li>
<li>criteria</li>
<li>expectation</li>
<li>number of days in advance the reminder e mail will be sent</li>
<li>an array of the dates the trials will take place</li>
<li>the ethics clearance file passed to the fetch request through an html form</li>
<li>a txt file passed through with the content of the reminder email</li>
</ul>
<h2 id='get-all-studies'>get all studies</h2><pre class="highlight javascript tab-javascript"><code>
<span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">'https://research-stream.herokuapp.com/study/get'</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">method</span><span class="p">:</span> <span class="s2">"GET"</span>
    <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
  <span class="p">})</span>

</code></pre>
<blockquote>
<p>This code return an array of jsons like this</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some details"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"lab"</span><span class="p">:</span><span class="w">  </span><span class="s2">"a place"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"contactInfo"</span><span class="p">:</span><span class="w">  </span><span class="s2">"info"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"location"</span><span class="p">:</span><span class="w">  </span><span class="s2">"a city"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"compensation"</span><span class="p">:</span><span class="w">  </span><span class="s2">"some form of compensation"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"criteria"</span><span class="p">:</span><span class="w">  </span><span class="s2">"study entrant criteria"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"expectation"</span><span class="p">:</span><span class="w">  </span><span class="s2">"expectation"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w">  </span><span class="s2">"somebody@somewhere.com"</span><span class="w"> </span><span class="p">,</span><span class="w">
    </span><span class="s2">"researcher"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a persons name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ethicsclearance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"buffer file data for the submitted file"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"emailcontent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"buffer data for a text file containing the e mail content"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"emaildateoffset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"the number of days an e mail will be sent in advance to warn a participant"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"dates"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[{date:date of the trial, participant:_id of the participant, emaildate:date the warning e mail will be sent to the participant}]"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint return a list of all studies.</p>

<p>accessible by</p>

<ul>
<li>https://research-stream.herokuapp.com/study/get</li>
</ul>
<h2 id='get-studies-by-their-id'>get Studies by their ID</h2>
<blockquote>
<p>the ethics clearance data of a study is stored as buffer data</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code>
<span class="nx">fetch</span><span class="p">(</span><span class="s1">'https://research-stream.herokuapp.com/study/id/&lt;someID&gt;:id'</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">method</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">();</span>
  <span class="p">})</span>

<span class="nx">fetch</span><span class="p">(</span><span class="s1">'https://research-stream.herokuapp.com/study/EthicsClearance/&lt;someID&gt;:id'</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">method</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">;</span>
  <span class="p">})</span>
</code></pre>
<p>These 2 endpoints return 
a) a study by its ID
B) the Ethics Clearance file for a study according to the study ID</p>
<h3 id='http-requests'>HTTP requests</h3>
<ul>
<li>https://research-stream.herokuapp.com/study/id/<someID>:id</li>
<li>https://research-stream.herokuapp.com/study/EthicsClearance/<someID>:id</li>
</ul>
<h3 id='parameters-2'>parameters</h3>
<ul>
<li>ID of an existing study (in the url)</li>
</ul>
<h2 id='get-studies-by-other-parameters'>get studies by other parameters</h2>
<blockquote>
<p>before accessing any of the folloing endpoints login</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code>
<span class="nx">fetch</span><span class="p">(</span><span class="s1">'https://research-stream.herokuapp.com/study/name/&lt;someName&gt;'</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">method</span><span class="p">:</span> <span class="s2">"GET"</span>
    <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">();</span>
  <span class="p">})</span>

<span class="nx">fetch</span><span class="p">(</span><span class="s1">'https://research-stream.herokuapp.com/study/location/&lt;someLocation&gt;'</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">method</span><span class="p">:</span> <span class="s2">"GET"</span>
    <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">();</span>
  <span class="p">})</span>

<span class="nx">fetch</span><span class="p">(</span><span class="s1">'https://research-stream.herokuapp.com/study/lab/&lt;some lab&gt;'</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">method</span><span class="p">:</span> <span class="s2">"GET"</span>
    <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">();</span>
  <span class="p">})</span>

<span class="nx">fetch</span><span class="p">(</span><span class="s1">'https://research-stream.herokuapp.com/study/researcher/&lt;some researcher&gt;'</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">method</span><span class="p">:</span> <span class="s2">"GET"</span>
    <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">();</span>
  <span class="p">}</span>
</code></pre>
<p>These endpoints return studies by name, location, lab, and researcher, as well as one endpoint to return the proof of ethics clearance for the study matching an id specified.</p>

<p>These studies are returned in a json containging an array of studies in the same format at the endpoint above.</p>

<table><thead>
<tr>
<th>HTTP request</th>
<th>returns</th>
</tr>
</thead><tbody>
<tr>
<td>* https://research-stream.herokuapp.com/study/name/name:<someName></td>
<td>returns all studies under a certain name</td>
</tr>
<tr>
<td>* https://research-stream.herokuapp.com/study/location/location:<someLocation></td>
<td>returns all studies in a specific location</td>
</tr>
<tr>
<td>* https://research-stream.herokuapp.com/study/lab/lab:<someLab></td>
<td>returns all studies performaed in a specific lab</td>
</tr>
<tr>
<td>* https://research-stream.herokuapp.com/study/researcher/researcher:<somereRearcher></td>
<td>returns all studies created by a specific researcher</td>
</tr>
</tbody></table>
<h3 id='parameters-in-urls-of-requests'>parameters (in urls of requests)</h3>
<ul>
<li>a name</li>
<li>a location</li>
<li>a lab</li>
<li>a researcher</li>
</ul>
<h1 id='messageing-system-instruction'>Messageing system instruction</h1><h2 id='files'>files</h2>
<ol>
<li>dump_from_server.js</li>
<li>send_msg.js</li>
<li>index.js</li>
<li>encryption.js</li>
</ol>
<h2 id='how-to-use-it'>how to use it</h2>
<ol>
<li>when user open the chat page, set up the user and chatroom</li>
<li>add this code in the webpage to trigger socket.io</li>
<li>dump_from_server.dump will return the chat history, need to insert it into the web page. </li>
<li>encryption haven&#39;t been tested yet</li>
</ol>
<h1 id='usage-of-email-js-and-job-js'>usage of email.js and job.js</h1><h3 id='email'>email</h3>
<p>this is the method for sending the email, 
open the file and 
  1. set service to the email provider, 
  2. set the user and from to your own email address, 
  3. set the pass to your authentication passcode</p>
<h2 id='need-test'>NEED TEST!</h2>
<p>run this to send email.</p>
<pre class="highlight javascript tab-javascript"><code>
<span class="kr">const</span> <span class="nx">email</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'email.js'</span><span class="p">)</span>
<span class="nx">send</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">email</span><span class="p">()</span>
<span class="nx">send</span><span class="p">.</span><span class="nx">setDest</span><span class="p">(</span><span class="s2">"destination email addr"</span><span class="p">)</span>
<span class="nx">send</span><span class="p">.</span><span class="nx">setTxt</span><span class="p">(</span><span class="s2">"path to the text file"</span><span class="p">)</span>
<span class="nx">send</span><span class="p">.</span><span class="nx">setsubject</span><span class="p">(</span><span class="s2">"subject of the email"</span><span class="p">)</span>
<span class="nx">send</span><span class="p">.</span><span class="nx">sendMail</span><span class="p">()</span>
</code></pre><h3 id='job'>job</h3>
<p>config the heroku scheduler to run this script daily, it will check the database and send email to user who have send_date = today </p>

<p>NEED TEST! 
<em>run this locally first to see if it can grab data from database.</em></p>
<h1 id='todo'>TODO</h1>
<ol>
<li>~<del>Messageing endpoint documentation</del>~</li>
<li>calander intergration</li>
</ol>
<h1 id='errors'>Errors</h1>
<aside class="notice">
useful error messages are not fully implemented, most errors do not currently return the correct error code
</aside>

<p>API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- Your request is invalid.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized -- Your API key is wrong.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- The specified user or study could not be found.</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed</td>
</tr>
<tr>
<td>406</td>
<td>Invalid Input</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error -- We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable -- We&#39;re temporarily offline for maintenance. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
